# Deploy: run your deploy script on the server via SSH.
#
# Setup (Settings → Secrets and variables → Actions):
#   DEPLOY_HOST    – server hostname or IP
#   DEPLOY_USER   – SSH user (e.g. ubuntu)
#   SSH_PRIVATE_KEY – private key for SSH (full PEM content)
#   DEPLOY_PATH   – repo path on server (e.g. /home/ubuntu/uzahX)
#
# Trigger: manual (Run workflow) or on push to main (uncomment below).

name: Deploy

on:
  workflow_dispatch: {}
  # push:
  #   branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Deploy on server
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.DEPLOY_HOST }}
          username: ${{ secrets.DEPLOY_USER }}
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          script: |
            set -e
            cd "${{ secrets.DEPLOY_PATH }}"
            git pull
            ./scripts/deploy.sh
